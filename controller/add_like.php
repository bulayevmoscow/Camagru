<?php	// TODO Допилить лайки	require_once __DIR__.'/db.php';	session_start();	$user = $_SESSION['logged_user'];	$conn = db_connect();	$post = $_POST['post'];	$err = array();	if ($user == NULL) {		header('Location: /index.php?page=register&msg=Для продолжения залогиньтесь');		exit();	}	if (!is_numeric($post))		$err[] = 'Неверный код поста';	if ($err) {		header('Location: /index.php/?page=gallery'.parse_nbr_page($_SERVER['HTTP_REFERER']).'&err='.implode(',', $err));		exit();	}    $query = sprintf("SELECT count(*) from post where by='%s' and id=%d and is_like=true;", $user, $post);	if (($conn->query($query)->fetch())[0] === 0){		$query = sprintf("insert into post (is_like, by, id) values (true, '%s', %d);", $user, $post);	} else {		$query = sprintf("delete FROM post WHERE is_like=true and by='%s' and id=%d", $user, $post);	}	$conn->query($query);	header('Location: /index.php/?page=gallery'.parse_nbr_page($_SERVER['HTTP_REFERER']));